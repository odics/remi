<!DOCTYPE html>
<html>
  <head>
    <script
      src="https://code.jquery.com/jquery-3.2.1.slim.min.js"
      integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
      crossorigin="anonymous"
    ></script>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Font Awesome -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap"
      rel="stylesheet"
    />
    <!-- MDB -->
    <!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.0.1/mdb.min.css" rel="stylesheet" /> -->
    <!-- <link rel="stylesheet" href="{{ url_for('static', filename='css/mdb.dark.min.css') }}"> -->

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/select2-bootstrap-5-theme@1.3.0/dist/select2-bootstrap-5-theme.min.css"
    />

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Libre+Franklin:wght@100;400&family=Oxygen&family=Quicksand:wght@300;400;500&display=swap" rel="stylesheet">
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
      integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='test.css') }}"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Libre+Franklin:wght@100;400&family=Oxygen&family=Quicksand:wght@300;400;500&display=swap"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display&family=Varela&display=swap"
      rel="stylesheet"
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Playfair+Display&family=Roboto:wght@300&family=Varela&display=swap"
      rel="stylesheet"
    />
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Barlow:wght@100;300&display=swap");
    </style>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20,300,0,0" />
    <title>{% block title %}Home{% endblock %}</title>
  </head>

  <body>
    <nav class="navbar">
      <div class="logo">R•E•M•I</div>
      <div class="nav-grid">
        <div class="nav-layout">
          <span class="nav-icon"><i class="fa-solid fa-home"></i></span>
          <a class="menu-link" href="/"><span class="nav-text">Home</span></a>
          <span class="nav-other"></span>
        </div>
        <div class="dropdown">
          <div class="nav-layout">
            <span class="nav-icon"
              ><i class="fa-solid fa-pen-to-square"></i
            ></span>
            <span class="nav-text">Add Recipe</span>
            <span class="nav-other"
              ><i class="fa-solid fa-angle-down"></i
            ></span>
          </div>
          <div class="menu-items">
            <ul class="menu-list">
              <li><a class="menu-link" href="/add_recipe">Import Recipe</a></li>
              <li><a class="menu-link" href="/create_recipe">Create Recipe</a></li>
            </ul>
          </div>
        </div>
        <div class="nav-layout">
          <span class="nav-icon"
            ><i class="fa-solid fa-rectangle-list"></i
          ></span>
          <a class="menu-link" href="/all_recipes"><span class="nav-text">All Recipes</span></a>
          <span class="nav-other"><span class="pill">{{ total_recipes }}</span></span>
        </div>
        <div class="nav-layout">
          <span class="nav-icon"><i class="fa-solid fa-heart"></i></span>
          <a class="menu-link" href="/favorites"><span class="nav-text">Favorites</span></a>
          <span class="nav-other"><span class="pill">{{ favorite_total }}</span></span>
        </div>
        <div class="nav-divider">
          <hr />
        </div>
        <div class="nav-layout-search">
          <span class="nav-icon"
            ><i class="fa-solid fa-magnifying-glass"></i
          ></span>
          <span class="nav-text"
            ><input class="search-recipes" placeholder="Search recipes"
          /></span>
        </div>
        <div class="nav-layout">
          <span class="nav-icon"><i class="fa-solid fa-tags"></i></span>
          <span class="nav-text">Recipe Tags</span>
          <span class="nav-other"></span>
        </div>
        <div class="nav-layout">
          <span class="nav-icon"
            ><i class="fa-solid fa-cart-shopping"></i
          ></span>
          <a class="menu-link" href="/cart"><span class="nav-text">Cart</span></a>
          {% if shopping_list %}
          <span class="nav-other"><span class="pill">{{ shopping_list }}</span></span>
          {% else %}
          <span class="nav-other"><span class="pill">0</span></span>
          {% endif %}
        </div>
      </div>
      <div class="bottom-wrapper">
        <div class="nav-layout">
          <span class="nav-icon"
            ><i class="fa-solid fa-right-from-bracket"></i
          ></span>
          <span class="nav-text">Logout</span>
          <span class="nav-other"></span>
        </div>
        <div class="nav-layout">
          <span class="nav-icon"><i class="fa-solid fa-gear"></i></span>
          <span class="nav-text">Settings</span>
          <span class="nav-other"></span>
        </div>
      </div>
    </nav>

    <main>
    <!-- {% with messages = get_flashed_messages(with_categories=true) %} {% if
    messages %} {% for category, message in messages %} {% if category ==
    'error' %}
    <div class="alert alert-danger alert-dismissable fade show" role="alert">
      {{ message }}
      <button type="button" class="close" data-dismiss="alert">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    {% else %}
    <div
      class="alert alert-warning alert-dismissible"
      role="alert"
      data-mdb-color="success"
    >
      {{ message }}
      <button type="button" class="btn-close" data-mdb-dismiss="alert"></button>
    </div>
    {% endif %} {% endfor %} {% endif %} {% endwith %}  -->
    {% block content %} 
    {% endblock %}
    <div class="modal-container" id="modal-container">
      <div class="modal">
        <p id="modal-inner-text"></p>
        <div>
          <a class="modal-delete" id="delete-link" href="#">Delete Recipe</a>
          <button class="button-primary" id="close" onclick="close_modal()">Close</button>
        </div>
      </div>
    </div>
  </main>
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
      integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
      crossorigin="anonymous"
    ></script>

    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    <!-- MDB -->
    <script
      type="text/javascript"
      src="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/6.0.1/mdb.min.js"
    ></script>

    <script>
      $("#delete_recipe").on("show.bs.modal", function (event) {
        var button = $(event.relatedTarget); // Button that triggered the modal
        var title = button.data("recipe-title"); // Extract info from data-* attributes
        var recipe = button.data("recipe-uuid");
        var modal = $(this);

        var new_html =
          '<button type="button" class="btn btn-secondary btn-sm" data-mdb-dismiss="modal">Close</button><button class="btn btn-danger btn-sm" onclick="delete_recipe(\'' +
          recipe +
          '\')"><i class="fa fa-trash"></i> Delete Recipe</button>';

        modal.find(".modal-title").text("Delete " + title + "?");
        modal.find(".modal-footer").html(new_html);
      });
    </script>

    <script>
      $("#delete_recipe_go_home").on("show.bs.modal", function (event) {
        var button = $(event.relatedTarget); // Button that triggered the modal
        var title = button.data("recipe-title"); // Extract info from data-* attributes
        var recipe = button.data("recipe-uuid");
        var modal = $(this);

        var new_html =
          '<button type="button" class="btn btn-secondary btn-sm" data-mdb-dismiss="modal">Close</button><button class="btn btn-danger btn-sm" onclick="delete_recipe_go_home(\'' +
          recipe +
          '\')"><i class="fa fa-trash"></i> Delete Recipe</button>';

        modal.find(".modal-title").text("Delete " + title + "?");
        modal.find(".modal-footer").html(new_html);
      });
    </script>

    <script>
      function delete_recipe(recipe_id) {
        fetch("/delete_recipe", {
          method: "POST",
          body: JSON.stringify({ recipe_id: recipe_id }),
        }).then((_res) => {
          var currentScrollPosition = $(window).scrollTop();
          location.reload();
          setTimeout(function () {
            $(window).scrollTop(currentScrollPosition);
          }, 100);
        });
      }
    </script>

    <script>
      function delete_recipe_go_home(recipe_id) {
        fetch("/delete_recipe_go_home", {
          method: "POST",
          body: JSON.stringify({ recipe_id: recipe_id }),
        }).then((_res) => {
          // window.location.href = "/";
          console.log(_res);
        });
      }
    </script>

    <script>
      function clear_cart(user_id) {
        fetch("/clear_cart", {
          method: "POST",
          body: JSON.stringify({ user_id: user_id }),
        }).then((_res) => {
          window.location.href = "/cart";
        });
      }
    </script>

    <script>
      function delete_shopping_item(item_id) {
        fetch("/delete_item", {
          method: "POST",
          body: JSON.stringify({ item_id: item_id }),
        }).then((_res) => {
          var currentScrollPosition = $(window).scrollTop();
          location.reload();
          setTimeout(function () {
            $(window).scrollTop(currentScrollPosition);
          }, 100);
        });
      }
    </script>

    <script>
      function add_favorite(recipe_id) {
        fetch("/add_favorite", {
          method: "POST",
          body: JSON.stringify({ recipe_id: recipe_id }),
        }).then((_res) => {
          var currentScrollPosition = $(window).scrollTop();
          location.reload();
          setTimeout(function () {
            $(window).scrollTop(currentScrollPosition);
          }, 100);
        });
      }
    </script>

    <script>
      function remove_favorite(recipe_id) {
        fetch("/remove_favorite", {
          method: "POST",
          body: JSON.stringify({ recipe_id: recipe_id }),
        }).then((_res) => {
          var currentScrollPosition = $(window).scrollTop();
          location.reload();
          setTimeout(function () {
            $(window).scrollTop(currentScrollPosition);
          }, 100);
        });
      }
    </script>

    <script>
      function delete_tag(tag_id, view_id, recipe_id) {
        var recipe_url = view_id;
        fetch("/delete_tag", {
          method: "POST",
          body: JSON.stringify({ tag_id: tag_id, recipe_id: recipe_id }),
        }).then((_res) => {
          var currentScrollPosition = $(window).scrollTop();
          location.reload();
          setTimeout(function () {
            $(window).scrollTop(currentScrollPosition);
          }, 100);
        });
      }
    </script>

    <script>
      function copyShopping(list_to_copy) {
        var copyText = $(list_to_copy).data();

        navigator.clipboard.writeText(copyText.copy);
      }
    </script>

    <script>
      $(document).ready(function () {
        $(".recipe-tags").select2({
          theme: "bootstrap-5",
          placeholder: "Tag your recipe here...",
        });
      });
    </script>

    <script>
      $(document).ready(function () {
        $(".recipe-tags2").select2({
          theme: "bootstrap-5",
          placeholder: "Tag your recipe here... start typing to create tags",
          width: "resolve",
        });
      });
    </script>

    <script>
      $(document).ready(function () {
        $(".recipe-tags2").select2({
          theme: "bootstrap-5",
          placeholder: "Tag your recipe here... start typing to create tags",
        });
      });
    </script>

    <script>
   

    function add_ingredient() {
      var ingredient_container = document.getElementById("ingredient_list");
      var new_ingredient = document.createElement("div");
      new_ingredient.setAttribute("class", "cr-ingredient-wrapper");
      
      var new_ingredient_textbox = document.createElement("input");
      new_ingredient_textbox.setAttribute("class", "text-input");
      new_ingredient_textbox.setAttribute("name", "ingredient_list");
      new_ingredient_textbox.setAttribute("placeholder", "Enter ingredient.");

      var new_ingredient_select = document.createElement("select");
      new_ingredient_select.setAttribute("class", "cr-ing-preview");
      new_ingredient_select.setAttribute("name", "ing_type")
      
      var ing_type = document.createElement("option");
        ing_type.value = "misc";
        ing_type.text = "Misc.";
        new_ingredient_select.appendChild(ing_type);

        var ing_type = document.createElement("option");
        ing_type.value = "produce";
        ing_type.text = "Produce";
        new_ingredient_select.appendChild(ing_type);

        var ing_type = document.createElement("option");
        ing_type.value = "meat";
        ing_type.text = "Meat";
        new_ingredient_select.appendChild(ing_type);

        var ing_type = document.createElement("option");
        ing_type.value = "coffee_tea";
        ing_type.text = "Coffee and Tea";
        new_ingredient_select.appendChild(ing_type);

        var ing_type = document.createElement("option");
        ing_type.value = "pasta";
        ing_type.text = "Pasta";
        new_ingredient_select.appendChild(ing_type);

        var ing_type = document.createElement("option");
        ing_type.value = "frozen";
        ing_type.text = "Frozen Food";
        new_ingredient_select.appendChild(ing_type);

        var ing_type = document.createElement("option");
        ing_type.value = "dairy_bread";
        ing_type.text = "Dairy";
        new_ingredient_select.appendChild(ing_type);

      var new_ingredient_delete = document.createElement("div");
      new_ingredient_delete.setAttribute("class", "cr-delete");

      var new_delete_button = document.createElement("i");
      new_delete_button.setAttribute("class", "fa-solid fa-square-xmark fa-lg");
      new_delete_button.setAttribute("onclick", "remove_added_ingredient(this)");
      
      new_ingredient_delete.appendChild(new_delete_button);
      

      new_ingredient.appendChild(new_ingredient_textbox);
      new_ingredient.appendChild(new_ingredient_select);
      new_ingredient.appendChild(new_ingredient_delete);
      ingredient_container.appendChild(new_ingredient);
    }
    </script>

    <script>
      function add_recipe_step() {
        var instructions = document.getElementById("instruction-container");
        var new_instruction = document.createElement("div");
        new_instruction.setAttribute("style", "margin-top: .5rem;")
  
        new_instruction.innerHTML = '<div class="cr-step"><div><textarea class="text-area" id="instructions" name="instructions" rows="3" placeholder="Enter recipe step."></textarea></div><div><i class="fa-solid fa-square-xmark fa-lg" onclick="remove_added_step(this)"></i></div></div>'

        instructions.appendChild(new_instruction);
      }
    </script>

    <script>
      function remove_added_ingredient(ing) {

        ing.parentElement.parentElement.remove();
        // var ingredient_to_delete = document.getElementById("ingredient_list");
        // var ingredient_type_to_delete =
        //   document.getElementById("ingredient_type");
        // var button_to_delete = document.getElementById("delete_button");

        // ingredient_to_delete.removeChild(ingredient_to_delete.lastChild);
        // ingredient_type_to_delete.removeChild(
        //   ingredient_type_to_delete.lastChild
        // );
        // button_to_delete.removeChild(button_to_delete.lastChild);
      }
    </script>

    <script>
      function remove_added_step(step) {
      
        step.parentElement.parentElement.remove();
      }
    </script>

    <script>

var modal = document.getElementById("modal-container");

var close_btn = document.getElementById("close");

function close_modal() {
  modal.style.display = "none";
}

function delete_recipe(e) {
  var recipe_id = e.dataset.recipeId;
  var delete_button = document.getElementById("confirm-delete");
  delete_button.setAttribute("onClick", 'delete_recipe_go_home("' + recipe_id + '");');
  var modal_text = document.getElementById("modal-inner-text");
  var recipe_title = e.dataset.recipeTitle;
  modal.style.display = "block";
  modal_text.innerText = "Are you sure you want to delete " + recipe_title + "?";
}

function new_delete(e) {
  var recipe_id = e.dataset.recipeId;
  var delete_link = document.getElementById("delete-link")
  var modal_text = document.getElementById("modal-inner-text");
  var recipe_title = e.dataset.recipeTitle;
  modal.style.display = "block";
  modal_text.innerText = "Are you sure you want to delete " + recipe_title + "?";

  delete_link.setAttribute("href", "/delete_recipe_go_home/" + recipe_id)
}
</script>

<script>
  var flashAlert = document.getElementById("alert");
  var flashMessage = document.getElementById("alert-close");

  flashMessage.onclick = function() {
    flashAlert.style.display = "none";
  }

</script>

  </body>
</html>
